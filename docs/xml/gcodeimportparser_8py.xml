<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.10.0" xml:lang="en-US">
  <compounddef id="gcodeimportparser_8py" kind="file" language="Python">
    <compoundname>gcodeimportparser.py</compoundname>
    <innerclass refid="classcam_1_1gcodeimportparser_1_1GcodeParser" prot="public">cam::gcodeimportparser::GcodeParser</innerclass>
    <innerclass refid="classcam_1_1gcodeimportparser_1_1GcodeModel" prot="public">cam::gcodeimportparser::GcodeModel</innerclass>
    <innerclass refid="classcam_1_1gcodeimportparser_1_1Segment" prot="public">cam::gcodeimportparser::Segment</innerclass>
    <innerclass refid="classcam_1_1gcodeimportparser_1_1Layer" prot="public">cam::gcodeimportparser::Layer</innerclass>
    <innernamespace refid="namespacecam">cam</innernamespace>
    <innernamespace refid="namespacecam_1_1gcodeimportparser">cam::gcodeimportparser</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacecam_1_1gcodeimportparser" refkind="compound"><highlight class="stringliteral">&quot;&quot;&quot;BlenderCAM<sp/>&apos;gcodeimportparser.py&apos;</highlight></codeline>
<codeline lineno="2"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="3"><highlight class="stringliteral">Code<sp/>modified<sp/>from<sp/>YAGV<sp/>(Yet<sp/>Another<sp/>G-code<sp/>Viewer)<sp/>-<sp/>https://github.com/jonathanwin/yagv</highlight></codeline>
<codeline lineno="4"><highlight class="stringliteral">No<sp/>license<sp/>terms<sp/>found<sp/>in<sp/>YAGV<sp/>repo,<sp/>will<sp/>assume<sp/>GNU<sp/>release</highlight></codeline>
<codeline lineno="5"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>math</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>numpy<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>np</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>bpy</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13" refid="namespacecam_1_1gcodeimportparser_1af2f94876c6227b47d87730d7ca322909" refkind="member"><highlight class="normal">np.set_printoptions(suppress=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/></highlight><highlight class="comment">#<sp/>suppress<sp/>scientific<sp/>notation<sp/>in<sp/>subdivide<sp/>functions<sp/>linspace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="namespacecam_1_1gcodeimportparser_1aa6ef446acab03d0b240ce4ba37a739c3" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacecam_1_1gcodeimportparser_1aa6ef446acab03d0b240ce4ba37a739c3" kindref="member">import_gcode</ref>(context,<sp/>filepath):</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;Running<sp/>read_some_data...&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/>scene<sp/>=<sp/>context.scene</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/>mytool<sp/>=<sp/>scene.cam_import_gcode</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>time</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/>then<sp/>=<sp/>time.time()</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/>parse<sp/>=<sp/><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser" kindref="compound">GcodeParser</ref>()</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/>model<sp/>=<sp/>parse.parseFile(filepath)</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>mytool.subdivide:</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>model.subdivide(mytool.max_segment_size)</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/>model.classifySegments()</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>mytool.split_layers:</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>model.draw(split_layers=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>model.draw(split_layers=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/>now<sp/>=<sp/>time.time()</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;Importing<sp/>Gcode<sp/>Took<sp/>&quot;</highlight><highlight class="normal">,<sp/>round(now<sp/>-<sp/>then,<sp/>1),<sp/></highlight><highlight class="stringliteral">&quot;Seconds&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{</highlight><highlight class="stringliteral">&apos;FINISHED&apos;</highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41" refid="namespacecam_1_1gcodeimportparser_1a0079f2bbd765282c819b15b22a8dbfba" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacecam_1_1gcodeimportparser_1a0079f2bbd765282c819b15b22a8dbfba" kindref="member">segments_to_meshdata</ref>(segments):<sp/><sp/></highlight><highlight class="comment">#<sp/>edges<sp/>only<sp/>on<sp/>extrusion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/>segs<sp/>=<sp/>segments</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/>verts<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/>edges<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/>del_offset<sp/>=<sp/>0<sp/><sp/></highlight><highlight class="comment">#<sp/>to<sp/>travel<sp/>segs<sp/>in<sp/>a<sp/>row,<sp/>one<sp/>gets<sp/>deleted,<sp/>need<sp/>to<sp/>keep<sp/>track<sp/>of<sp/>index<sp/>for<sp/>edges</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(segs)):</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>i<sp/>&gt;=<sp/>len(segs)<sp/>-<sp/>1:</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>segs[i].style<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;extrude&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verts.append([segs[i].coords[</highlight><highlight class="stringliteral">&apos;X&apos;</highlight><highlight class="normal">],<sp/>segs[i].coords[</highlight><highlight class="stringliteral">&apos;Y&apos;</highlight><highlight class="normal">],<sp/>segs[i].coords[</highlight><highlight class="stringliteral">&apos;Z&apos;</highlight><highlight class="normal">]])</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>start<sp/>of<sp/>extrusion<sp/>for<sp/>first<sp/>time</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>segs[i].style<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;travel&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>segs[i<sp/>+<sp/>1].style<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;extrude&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verts.append([segs[i].coords[</highlight><highlight class="stringliteral">&apos;X&apos;</highlight><highlight class="normal">],<sp/>segs[i].coords[</highlight><highlight class="stringliteral">&apos;Y&apos;</highlight><highlight class="normal">],<sp/>segs[i].coords[</highlight><highlight class="stringliteral">&apos;Z&apos;</highlight><highlight class="normal">]])</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verts.append([segs[i<sp/>+<sp/>1].coords[</highlight><highlight class="stringliteral">&apos;X&apos;</highlight><highlight class="normal">],<sp/>segs[i<sp/>+<sp/>1].coords[</highlight><highlight class="stringliteral">&apos;Y&apos;</highlight><highlight class="normal">],<sp/>segs[i<sp/>+<sp/>1].coords[</highlight><highlight class="stringliteral">&apos;Z&apos;</highlight><highlight class="normal">]])</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>edges.append([i<sp/>-<sp/>del_offset,<sp/>(i<sp/>-<sp/>del_offset)<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>mitte,<sp/>current<sp/>and<sp/>next<sp/>are<sp/>extrusion,<sp/>only<sp/>add<sp/>next,<sp/>current<sp/>is<sp/>already<sp/>in<sp/>vert<sp/>list</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>segs[i].style<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;extrude&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>segs[i<sp/>+<sp/>1].style<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;extrude&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verts.append([segs[i<sp/>+<sp/>1].coords[</highlight><highlight class="stringliteral">&apos;X&apos;</highlight><highlight class="normal">],<sp/>segs[i<sp/>+<sp/>1].coords[</highlight><highlight class="stringliteral">&apos;Y&apos;</highlight><highlight class="normal">],<sp/>segs[i<sp/>+<sp/>1].coords[</highlight><highlight class="stringliteral">&apos;Z&apos;</highlight><highlight class="normal">]])</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>edges.append([i<sp/>-<sp/>del_offset,<sp/>(i<sp/>-<sp/>del_offset)<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>segs[i].style<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;travel&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>segs[i<sp/>+<sp/>1].style<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;travel&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del_offset<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>verts,<sp/>edges</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72" refid="namespacecam_1_1gcodeimportparser_1a78824264a84e441ecc7438b7f004ac36" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacecam_1_1gcodeimportparser_1a78824264a84e441ecc7438b7f004ac36" kindref="member">obj_from_pydata</ref>(name,<sp/>verts,<sp/>edges=None,<sp/>close=True,<sp/>collection_name=None):</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>edges<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>join<sp/>vertices<sp/>into<sp/>one<sp/>uninterrupted<sp/>chain<sp/>of<sp/>edges.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>edges<sp/>=<sp/>[[i,<sp/>i<sp/>+<sp/>1]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(verts)<sp/>-<sp/>1)]</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>close:</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>edges.append([len(verts)<sp/>-<sp/>1,<sp/>0])<sp/><sp/></highlight><highlight class="comment">#<sp/>connect<sp/>last<sp/>to<sp/>first</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/>me<sp/>=<sp/>bpy.data.meshes.new(name)</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/>me.from_pydata(verts,<sp/>edges,<sp/>[])</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>obj<sp/>=<sp/>bpy.data.objects.new(name,<sp/>me)</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Move<sp/>into<sp/>collection<sp/>if<sp/>specified</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>collection_name<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="comment">#<sp/>make<sp/>argument<sp/>optional</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>collection<sp/>exists</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>collection<sp/>=<sp/>bpy.data.collections.get(collection_name)</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>collection:</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bpy.data.collections[collection_name].objects.link(obj)</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>collection<sp/>=<sp/>bpy.data.collections.new(collection_name)</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bpy.context.scene.collection.children.link(collection)<sp/><sp/></highlight><highlight class="comment">#<sp/>link<sp/>collection<sp/>to<sp/>main<sp/>scene</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bpy.data.collections[collection_name].objects.link(obj)</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/>obj.scale<sp/>=<sp/>(0.001,<sp/>0.001,<sp/>0.001)</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>bpy.context.view_layer.objects.active<sp/>=<sp/>obj</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/>obj.select_set(</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/>bpy.ops.object.transform_apply(location=</highlight><highlight class="keyword">False</highlight><highlight class="normal">,<sp/>rotation=</highlight><highlight class="keyword">False</highlight><highlight class="normal">,<sp/>scale=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>bpy.context.scene.cam_import_gcode.output<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;curve&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bpy.ops.object.convert(target=</highlight><highlight class="stringliteral">&apos;CURVE&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103" refid="classcam_1_1gcodeimportparser_1_1GcodeParser" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser" kindref="compound">GcodeParser</ref>:</highlight></codeline>
<codeline lineno="104" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a9d773066d297c5415ae8ff9f72b408d6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>comment<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>global,<sp/>to<sp/>access<sp/>in<sp/>other<sp/>classes(to<sp/>access<sp/>RGB<sp/>values<sp/>in<sp/>comment<sp/>above<sp/>when<sp/>parsing<sp/>M163).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Theres<sp/>probably<sp/>better<sp/>way</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1ae0a0bb17115a16b4b6d7abbef55bc249" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1ae0a0bb17115a16b4b6d7abbef55bc249" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="109" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1addfc7f9a6fbff61fcb186713318879ef" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1addfc7f9a6fbff61fcb186713318879ef" kindref="member">model</ref><sp/>=<sp/><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel" kindref="compound">GcodeModel</ref>(self)</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight></codeline>
<codeline lineno="111" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a12f5177d16deb369ed01208f04f8fa23" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a12f5177d16deb369ed01208f04f8fa23" kindref="member">parseFile</ref>(self,<sp/>path):</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>the<sp/>gcode<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>open(path,<sp/></highlight><highlight class="stringliteral">&apos;r&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>f:</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>init<sp/>line<sp/>counter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a9a39a9c0300f34bc37467ee65542386f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a9a39a9c0300f34bc37467ee65542386f" kindref="member">lineNb</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>for<sp/>all<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>line<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>f:</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>inc<sp/>line<sp/>counter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a9a39a9c0300f34bc37467ee65542386f" kindref="member">lineNb</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>remove<sp/>trailing<sp/>linefeed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="121" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a7a8607d4c4cd0878317b540ab8a5fd2c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a7a8607d4c4cd0878317b540ab8a5fd2c" kindref="member">line</ref><sp/>=<sp/>line.rstrip()</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>parse<sp/>a<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1ac0dc820285278526c3d681fdb0382144" kindref="member">parseLine</ref>()</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1addfc7f9a6fbff61fcb186713318879ef" kindref="member">model</ref></highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1ac0dc820285278526c3d681fdb0382144" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1ac0dc820285278526c3d681fdb0382144" kindref="member">parseLine</ref>(self):</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>strip<sp/>comments:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bits<sp/>=<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a7a8607d4c4cd0878317b540ab8a5fd2c" kindref="member">line</ref>.split(</highlight><highlight class="stringliteral">&apos;;&apos;</highlight><highlight class="normal">,<sp/>1)</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len(bits)<sp/>&gt;<sp/>1):</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GcodeParser.comment<sp/>=<sp/>bits[1]</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>extract<sp/>&amp;<sp/>clean<sp/>command</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>bits[0].strip()</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a_old<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(command)):<sp/><sp/></highlight><highlight class="comment">#<sp/>check<sp/>each<sp/>character<sp/>in<sp/>the<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>=<sp/>command[i]</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>a.isupper()<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>a_old<sp/>!=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>i<sp/>&gt;<sp/>0:<sp/><sp/></highlight><highlight class="comment">#<sp/>add<sp/>a<sp/>space<sp/>if<sp/>upper<sp/>case<sp/>letter<sp/>and<sp/>no<sp/>space<sp/>is<sp/>found<sp/>before</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s<sp/>+=<sp/>a</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a_old<sp/>=<sp/>a</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(s)</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>s</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>code<sp/>is<sp/>fist<sp/>word,<sp/>then<sp/>args</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>comm<sp/>=<sp/>command.split(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>1)</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>code<sp/>=<sp/>comm[0]<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len(comm)<sp/>&gt;<sp/>0)<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>args<sp/>=<sp/>comm[1]<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len(comm)<sp/>&gt;<sp/>1)<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>code:</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>convert<sp/>all<sp/>G01<sp/>and<sp/>G00<sp/>to<sp/>G1<sp/>and<sp/>G0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>code<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;G01&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>code<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;G1&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>code<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;G00&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>code<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;G0&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(self,<sp/></highlight><highlight class="stringliteral">&quot;parse_&quot;</highlight><highlight class="normal"><sp/>+<sp/>code):</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>getattr(self,<sp/></highlight><highlight class="stringliteral">&quot;parse_&quot;</highlight><highlight class="normal"><sp/>+<sp/>code)(args)</highlight></codeline>
<codeline lineno="160" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a83db65c29df056683ec1f0ace44dc986" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a83db65c29df056683ec1f0ace44dc986" kindref="member">last_command</ref><sp/>=<sp/>code</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>code[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;T&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1addfc7f9a6fbff61fcb186713318879ef" kindref="member">model</ref>.toolnumber<sp/>=<sp/>int(code[1:])</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1addfc7f9a6fbff61fcb186713318879ef" kindref="member">model</ref>.toolnumber)</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>code<sp/>doesn&apos;t<sp/>start<sp/>with<sp/>a<sp/>G<sp/>but<sp/>starts<sp/>with<sp/>a<sp/>coordinate<sp/>add<sp/>the<sp/>last<sp/>command<sp/>to<sp/>the<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>code[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;X&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>code[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;Y&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>code[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;Z&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a7a8607d4c4cd0878317b540ab8a5fd2c" kindref="member">line</ref><sp/>=<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a83db65c29df056683ec1f0ace44dc986" kindref="member">last_command</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a7a8607d4c4cd0878317b540ab8a5fd2c" kindref="member">line</ref></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1ac0dc820285278526c3d681fdb0382144" kindref="member">parseLine</ref>()<sp/><sp/></highlight><highlight class="comment">#<sp/>parse<sp/>this<sp/>line<sp/>again<sp/>with<sp/>the<sp/>corrections</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;Unsupported<sp/>gcode<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>str(code))</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1aa905fcf77304612d9c9d729009bb1cc2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1aa905fcf77304612d9c9d729009bb1cc2" kindref="member">parseArgs</ref>(self,<sp/>args):</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dic<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>args:</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bits<sp/>=<sp/>args.split()</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>bit<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>bits:</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>letter<sp/>=<sp/>bit[0]</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coord<sp/>=<sp/>float(bit[1:])</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ValueError:</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coord<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dic[letter]<sp/>=<sp/>coord</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dic</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a13b499a56e116539b97359549babf007" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a13b499a56e116539b97359549babf007" kindref="member">parse_G1</ref>(self,<sp/>args,<sp/>type=&quot;G1&quot;):</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>G1:<sp/>Controlled<sp/>move</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1addfc7f9a6fbff61fcb186713318879ef" kindref="member">model</ref>.do_G1(self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1aa905fcf77304612d9c9d729009bb1cc2" kindref="member">parseArgs</ref>(args),<sp/>type)</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a7e709ef80f16a2168e2db8f64e379882" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a7e709ef80f16a2168e2db8f64e379882" kindref="member">parse_G0</ref>(self,<sp/>args,<sp/>type=&quot;G0&quot;):</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>G1:<sp/>Controlled<sp/>move</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1addfc7f9a6fbff61fcb186713318879ef" kindref="member">model</ref>.do_G1(self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1aa905fcf77304612d9c9d729009bb1cc2" kindref="member">parseArgs</ref>(args),<sp/>type)</highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1aead9b776790ae8228391dcef251162ab" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1aead9b776790ae8228391dcef251162ab" kindref="member">parse_G90</ref>(self,<sp/>args):</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>G90:<sp/>Set<sp/>to<sp/>Absolute<sp/>Positioning</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1addfc7f9a6fbff61fcb186713318879ef" kindref="member">model</ref>.setRelative(</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="199" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a4530733314095c91d26edefc5aafa0a3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a4530733314095c91d26edefc5aafa0a3" kindref="member">parse_G91</ref>(self,<sp/>args):</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>G91:<sp/>Set<sp/>to<sp/>Relative<sp/>Positioning</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1addfc7f9a6fbff61fcb186713318879ef" kindref="member">model</ref>.setRelative(</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1afe07ed7b58c2c3701f13709df1cc241f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1afe07ed7b58c2c3701f13709df1cc241f" kindref="member">parse_G92</ref>(self,<sp/>args):</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>G92:<sp/>Set<sp/>Position</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1addfc7f9a6fbff61fcb186713318879ef" kindref="member">model</ref>.do_G92(self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1aa905fcf77304612d9c9d729009bb1cc2" kindref="member">parseArgs</ref>(args))</highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight></codeline>
<codeline lineno="207" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1ad1fcff07178ae82267e8f431946ae94c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1ad1fcff07178ae82267e8f431946ae94c" kindref="member">warn</ref>(self,<sp/>msg):</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;[WARN]<sp/>Line<sp/>%d:<sp/>%s<sp/>(Text:&apos;%s&apos;)&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a9a39a9c0300f34bc37467ee65542386f" kindref="member">lineNb</ref>,<sp/>msg,<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a7a8607d4c4cd0878317b540ab8a5fd2c" kindref="member">line</ref>))</highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight></codeline>
<codeline lineno="210" refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1ab661d91daf66cd54c13ab9fe1193955b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1ab661d91daf66cd54c13ab9fe1193955b" kindref="member">error</ref>(self,<sp/>msg):</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;[ERROR]<sp/>Line<sp/>%d:<sp/>%s<sp/>(Text:&apos;%s&apos;)&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a9a39a9c0300f34bc37467ee65542386f" kindref="member">lineNb</ref>,<sp/>msg,<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a7a8607d4c4cd0878317b540ab8a5fd2c" kindref="member">line</ref>))</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classException" kindref="compound">Exception</ref>(</highlight><highlight class="stringliteral">&quot;[ERROR]<sp/>Line<sp/>%d:<sp/>%s<sp/>(Text:&apos;%s&apos;)&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a9a39a9c0300f34bc37467ee65542386f" kindref="member">lineNb</ref>,<sp/>msg,<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser_1a7a8607d4c4cd0878317b540ab8a5fd2c" kindref="member">line</ref>))</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight></codeline>
<codeline lineno="215" refid="classcam_1_1gcodeimportparser_1_1GcodeModel" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel" kindref="compound">GcodeModel</ref>:</highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight></codeline>
<codeline lineno="217" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1ac5e1129b0a0d19d3fcf4b82f6a871c46" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1ac5e1129b0a0d19d3fcf4b82f6a871c46" kindref="member">__init__</ref>(self,<sp/>parser):</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>save<sp/>parser<sp/>for<sp/>messages</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a799d196e219adaaf3f2bc7cd4ae89f33" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a799d196e219adaaf3f2bc7cd4ae89f33" kindref="member">parser</ref><sp/>=<sp/>parser</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>latest<sp/>coordinates<sp/>&amp;<sp/>extrusion<sp/>relative<sp/>to<sp/>offset,<sp/>feedrate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="221" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aafac653a462e34dc5b0519b08398d5d0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aafac653a462e34dc5b0519b08398d5d0" kindref="member">relative</ref><sp/>=<sp/>{</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;F&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">:<sp/>0.0}</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>offsets<sp/>for<sp/>relative<sp/>coordinates<sp/>and<sp/>position<sp/>reset<sp/>(G92)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="228" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1abe098ab5b00f9e2cadfebbf90b523247" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1abe098ab5b00f9e2cadfebbf90b523247" kindref="member">offset</ref><sp/>=<sp/>{</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">:<sp/>0.0}</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>true,<sp/>args<sp/>for<sp/>move<sp/>(G1)<sp/>are<sp/>given<sp/>relatively<sp/>(default:<sp/>absolute)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a0376614b49175ced44870641b968eff7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a0376614b49175ced44870641b968eff7" kindref="member">isRelative</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a9411c62a39d8aba63d1576773976b177" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a9411c62a39d8aba63d1576773976b177" kindref="member">color</ref><sp/>=<sp/>[0,<sp/>0,<sp/>0,<sp/>0,<sp/>0,<sp/>0,<sp/>0,<sp/>0]<sp/><sp/></highlight><highlight class="comment">#<sp/>RGBCMYKW</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a8dc3da8a11e2755c2f779e42168757c0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a8dc3da8a11e2755c2f779e42168757c0" kindref="member">toolnumber</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="239" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa72471c5bb5d8309023c6b82dc34d284" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa72471c5bb5d8309023c6b82dc34d284" kindref="member">segments</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="240" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1ae49c085578c03aad45f407ec544c883f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1ae49c085578c03aad45f407ec544c883f" kindref="member">layers</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight></codeline>
<codeline lineno="242" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a51ce8c24cd510056704e5287c4fbf71a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a51ce8c24cd510056704e5287c4fbf71a" kindref="member">do_G1</ref>(self,<sp/>args,<sp/>type):</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>G0/G1:<sp/>Rapid/Controlled<sp/>move</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>clone<sp/>previous<sp/>coords</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coords<sp/>=<sp/>dict(self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aafac653a462e34dc5b0519b08398d5d0" kindref="member">relative</ref>)</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>update<sp/>changed<sp/>coords</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>axis<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>args.keys():</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>print(coords)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>axis<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>coords:</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a0376614b49175ced44870641b968eff7" kindref="member">isRelative</ref>:</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coords[axis]<sp/>+=<sp/>args[axis]</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coords[axis]<sp/>=<sp/>args[axis]</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a72f71d9d0c016e8b19b325c951f1aef2" kindref="member">warn</ref>(</highlight><highlight class="stringliteral">&quot;Unknown<sp/>axis<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal"><sp/>%<sp/>axis)</highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>build<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>absolute<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">:<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1abe098ab5b00f9e2cadfebbf90b523247" kindref="member">offset</ref>[</highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">]<sp/>+<sp/>coords[</highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">:<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1abe098ab5b00f9e2cadfebbf90b523247" kindref="member">offset</ref>[</highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">]<sp/>+<sp/>coords[</highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">:<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1abe098ab5b00f9e2cadfebbf90b523247" kindref="member">offset</ref>[</highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">]<sp/>+<sp/>coords[</highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;F&quot;</highlight><highlight class="normal">:<sp/>coords[</highlight><highlight class="stringliteral">&quot;F&quot;</highlight><highlight class="normal">]<sp/><sp/></highlight><highlight class="comment">#<sp/>no<sp/>feedrate<sp/>offset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="265"><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>gcode<sp/>line<sp/>has<sp/>no<sp/>E<sp/>=<sp/>travel<sp/>move</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>but<sp/>still<sp/>add<sp/>E<sp/>=<sp/>0<sp/>to<sp/>segment<sp/>(so<sp/>coords<sp/>dictionaries<sp/>have<sp/>same<sp/>shape<sp/>for<sp/>subdividing<sp/>linspace<sp/>function)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>args:<sp/><sp/></highlight><highlight class="comment">#<sp/>&quot;E&quot;<sp/>in<sp/>coords:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>absolute[</highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">]<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>absolute[</highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">]<sp/>=<sp/>args[</highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg<sp/>=<sp/><ref refid="classcam_1_1gcodeimportparser_1_1Segment" kindref="compound">Segment</ref>(</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type,</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>absolute,</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a9411c62a39d8aba63d1576773976b177" kindref="member">color</ref>,</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a8dc3da8a11e2755c2f779e42168757c0" kindref="member">toolnumber</ref>,</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>self.layerIdx,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a799d196e219adaaf3f2bc7cd4ae89f33" kindref="member">parser</ref>.lineNb,</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a799d196e219adaaf3f2bc7cd4ae89f33" kindref="member">parser</ref>.line)</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>only<sp/>add<sp/>seg<sp/>if<sp/>XYZ<sp/>changes<sp/>(skips<sp/>&quot;G1<sp/>Fxxx&quot;<sp/>only<sp/>lines<sp/>and<sp/>avoids<sp/>double<sp/>vertices<sp/>inside<sp/>Blender,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>because<sp/>XYZ<sp/>stays<sp/>the<sp/>same<sp/>on<sp/>such<sp/>a<sp/>segment.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>seg.coords[</highlight><highlight class="stringliteral">&apos;X&apos;</highlight><highlight class="normal">]<sp/>!=<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aafac653a462e34dc5b0519b08398d5d0" kindref="member">relative</ref>[</highlight><highlight class="stringliteral">&apos;X&apos;</highlight><highlight class="normal">]<sp/>+<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1abe098ab5b00f9e2cadfebbf90b523247" kindref="member">offset</ref>[</highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">]<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>seg.coords[</highlight><highlight class="stringliteral">&apos;Y&apos;</highlight><highlight class="normal">]<sp/>!=<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aafac653a462e34dc5b0519b08398d5d0" kindref="member">relative</ref>[</highlight><highlight class="stringliteral">&apos;Y&apos;</highlight><highlight class="normal">]<sp/>+<sp/>\</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1abe098ab5b00f9e2cadfebbf90b523247" kindref="member">offset</ref>[</highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">]<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>seg.coords[</highlight><highlight class="stringliteral">&apos;Z&apos;</highlight><highlight class="normal">]<sp/>!=<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aafac653a462e34dc5b0519b08398d5d0" kindref="member">relative</ref>[</highlight><highlight class="stringliteral">&apos;Z&apos;</highlight><highlight class="normal">]<sp/>+<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1abe098ab5b00f9e2cadfebbf90b523247" kindref="member">offset</ref>[</highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a15abc664be18cdcb366911614accb8d1" kindref="member">addSegment</ref>(seg)</highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>update<sp/>model<sp/>coords</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aafac653a462e34dc5b0519b08398d5d0" kindref="member">relative</ref><sp/>=<sp/>coords</highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight></codeline>
<codeline lineno="291" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a8825aa0c0c4b676428a0a7b547e18a38" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a8825aa0c0c4b676428a0a7b547e18a38" kindref="member">do_G92</ref>(self,<sp/>args):</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>G92:<sp/>Set<sp/>Position</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>this<sp/>changes<sp/>the<sp/>current<sp/>coords,<sp/>without<sp/>moving,<sp/>so<sp/>do<sp/>not<sp/>generate<sp/>a<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>no<sp/>axes<sp/>mentioned<sp/>==<sp/>all<sp/>axes<sp/>to<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>len(args.keys()):</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>args<sp/>=<sp/>{</highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">:<sp/>0.0,<sp/></highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">:<sp/>0.0,<sp/></highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">:<sp/>0.0}<sp/><sp/></highlight><highlight class="comment">#<sp/>,<sp/>&quot;E&quot;:0.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>update<sp/>specified<sp/>axes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>axis<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>args.keys():</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>axis<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1abe098ab5b00f9e2cadfebbf90b523247" kindref="member">offset</ref>:</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>transfer<sp/>value<sp/>from<sp/>relative<sp/>to<sp/>offset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1abe098ab5b00f9e2cadfebbf90b523247" kindref="member">offset</ref>[axis]<sp/>+=<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aafac653a462e34dc5b0519b08398d5d0" kindref="member">relative</ref>[axis]<sp/>-<sp/>args[axis]</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aafac653a462e34dc5b0519b08398d5d0" kindref="member">relative</ref>[axis]<sp/>=<sp/>args[axis]</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a72f71d9d0c016e8b19b325c951f1aef2" kindref="member">warn</ref>(</highlight><highlight class="stringliteral">&quot;Unknown<sp/>axis<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal"><sp/>%<sp/>axis)</highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight></codeline>
<codeline lineno="307" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa73825b3b8b92b267141f3516f5df8a6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa73825b3b8b92b267141f3516f5df8a6" kindref="member">do_M163</ref>(self,<sp/>args):</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>col<sp/>=<sp/>list(</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a9411c62a39d8aba63d1576773976b177" kindref="member">color</ref>)<sp/><sp/></highlight><highlight class="comment">#<sp/>list()<sp/>creates<sp/>new<sp/>list,<sp/>otherwise<sp/>you<sp/>just<sp/>change<sp/>reference<sp/>and<sp/>all<sp/>segs<sp/>have<sp/>same<sp/>color</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extr_idx<sp/>=<sp/>int(args[</highlight><highlight class="stringliteral">&apos;S&apos;</highlight><highlight class="normal">])<sp/><sp/></highlight><highlight class="comment">#<sp/>e.g.<sp/>M163<sp/>S0<sp/>P1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>weight<sp/>=<sp/>args[</highlight><highlight class="stringliteral">&apos;P&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>change<sp/>CMYKW</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>col[extr_idx<sp/>+<sp/>3]<sp/>=<sp/>weight<sp/><sp/></highlight><highlight class="comment">#<sp/>+3<sp/>weil<sp/>ersten<sp/>3<sp/>stellen<sp/>RGB<sp/>sind,<sp/>need<sp/>only<sp/>CMYKW<sp/>values<sp/>for<sp/>extrude</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a9411c62a39d8aba63d1576773976b177" kindref="member">color</ref><sp/>=<sp/>col</highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>take<sp/>RGB<sp/>values<sp/>for<sp/>seg<sp/>from<sp/>last<sp/>comment<sp/>(above<sp/>first<sp/>M163<sp/>statement)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>comment<sp/>=<sp/>eval(GcodeParser.comment)<sp/><sp/></highlight><highlight class="comment">#<sp/>string<sp/>comment<sp/>to<sp/>list</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>RGB<sp/>=<sp/>[GcodeParser.comment[1],<sp/>GcodeParser.com</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RGB<sp/>=<sp/>comment[:3]</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a9411c62a39d8aba63d1576773976b177" kindref="member">color</ref>[:3]<sp/>=<sp/>RGB</highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight></codeline>
<codeline lineno="322" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a4dc2921ca81c7d869006e7abe6aebeca" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a4dc2921ca81c7d869006e7abe6aebeca" kindref="member">setRelative</ref>(self,<sp/>isRelative):</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a0376614b49175ced44870641b968eff7" kindref="member">isRelative</ref><sp/>=<sp/>isRelative</highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="325" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a15abc664be18cdcb366911614accb8d1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a15abc664be18cdcb366911614accb8d1" kindref="member">addSegment</ref>(self,<sp/>segment):</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa72471c5bb5d8309023c6b82dc34d284" kindref="member">segments</ref>.append(segment)</highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a72f71d9d0c016e8b19b325c951f1aef2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a72f71d9d0c016e8b19b325c951f1aef2" kindref="member">warn</ref>(self,<sp/>msg):</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a799d196e219adaaf3f2bc7cd4ae89f33" kindref="member">parser</ref>.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a72f71d9d0c016e8b19b325c951f1aef2" kindref="member">warn</ref>(msg)</highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight></codeline>
<codeline lineno="331" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a5ab7ad50eafaf2e40181be6e535bc518" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a5ab7ad50eafaf2e40181be6e535bc518" kindref="member">error</ref>(self,<sp/>msg):</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a799d196e219adaaf3f2bc7cd4ae89f33" kindref="member">parser</ref>.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a5ab7ad50eafaf2e40181be6e535bc518" kindref="member">error</ref>(msg)</highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight></codeline>
<codeline lineno="334" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a11948d99dd78e3b93db9caea5c42d808" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a11948d99dd78e3b93db9caea5c42d808" kindref="member">classifySegments</ref>(self):</highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>start<sp/>model<sp/>at<sp/>0,<sp/>act<sp/>as<sp/>prev_coords</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coords<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;F&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">:<sp/>0.0}</highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>first<sp/>layer<sp/>at<sp/>Z=0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>currentLayerIdx<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>currentLayerZ<sp/>=<sp/>0<sp/><sp/></highlight><highlight class="comment">#<sp/>better<sp/>to<sp/>use<sp/>self.first_layer_height</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>layer<sp/>=<sp/>[]<sp/><sp/></highlight><highlight class="comment">#<sp/>add<sp/>layer<sp/>to<sp/>model.layers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i,<sp/>seg<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa72471c5bb5d8309023c6b82dc34d284" kindref="member">segments</ref>):</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>default<sp/>style<sp/>is<sp/>travel<sp/>(move,<sp/>no<sp/>extrusion)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>style<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;travel&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>no<sp/>horizontal<sp/>movement,<sp/>but<sp/>extruder<sp/>movement:<sp/>retraction/refill</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(seg.coords[&quot;X&quot;]<sp/>==<sp/>coords[&quot;X&quot;])<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(seg.coords[&quot;Y&quot;]<sp/>==<sp/>coords[&quot;Y&quot;])<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(seg.coords[&quot;Z&quot;]<sp/>==<sp/>coords[&quot;Z&quot;])<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(seg.coords[&quot;E&quot;]<sp/>!=<sp/>coords[&quot;E&quot;])<sp/>):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>style<sp/>=<sp/>&quot;retract&quot;<sp/>if<sp/>(seg.coords[&quot;E&quot;]<sp/>&lt;<sp/>coords[&quot;E&quot;])<sp/>else<sp/>&quot;restore&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>some<sp/>horizontal<sp/>movement,<sp/>and<sp/>positive<sp/>extruder<sp/>movement:<sp/>extrusion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>((seg.coords[</highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">]<sp/>!=<sp/>coords[</highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">])<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>(seg.coords[</highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">]<sp/>!=<sp/>coords[</highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">])<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>(</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg.coords[</highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">]<sp/>!=<sp/>coords[</highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">]))):<sp/><sp/></highlight><highlight class="comment">#<sp/>!=<sp/>coords[&quot;E&quot;]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>style<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;extrude&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>#force<sp/>extrude<sp/>if<sp/>there<sp/>is<sp/>some<sp/>movement</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>segments<sp/>to<sp/>layer<sp/>lists</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>look<sp/>ahead<sp/>and<sp/>if<sp/>next<sp/>seg<sp/>has<sp/>E<sp/>and<sp/>differenz<sp/>Z,<sp/>add<sp/>new<sp/>layer<sp/>for<sp/>current<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>i<sp/>==<sp/>len(self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa72471c5bb5d8309023c6b82dc34d284" kindref="member">segments</ref>)<sp/>-<sp/>1:</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>layer.append(seg)</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>currentLayerIdx<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg.style<sp/>=<sp/>style</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg.layerIdx<sp/>=<sp/>currentLayerIdx</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>add<sp/>layer<sp/>to<sp/>list<sp/>of<sp/>Layers,<sp/>used<sp/>to<sp/>later<sp/>draw<sp/>single<sp/>layer<sp/>objects</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1ae49c085578c03aad45f407ec544c883f" kindref="member">layers</ref>.append(layer)</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>positive<sp/>extruder<sp/>movement<sp/>of<sp/>next<sp/>point<sp/>in<sp/>a<sp/>different<sp/>Z<sp/>signals<sp/>a<sp/>layer<sp/>change<sp/>for<sp/>this<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa72471c5bb5d8309023c6b82dc34d284" kindref="member">segments</ref>[i].coords[</highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">]<sp/>!=<sp/>currentLayerZ<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa72471c5bb5d8309023c6b82dc34d284" kindref="member">segments</ref>[i<sp/>+<sp/>1].coords[</highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">]<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1ae49c085578c03aad45f407ec544c883f" kindref="member">layers</ref>.append(</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>layer)<sp/><sp/></highlight><highlight class="comment">#<sp/>layer<sp/>abschließen,<sp/>add<sp/>layer<sp/>to<sp/>list<sp/>of<sp/>Layers,<sp/>used<sp/>to<sp/>later<sp/>draw<sp/>single<sp/>layer<sp/>objects</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>layer<sp/>=<sp/>[]<sp/><sp/></highlight><highlight class="comment">#<sp/>start<sp/>new<sp/>layer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>currentLayerZ<sp/>=<sp/>seg.coords[</highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>currentLayerIdx<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>lookback,<sp/>previous<sp/>point<sp/>before<sp/>texrsuion<sp/>is<sp/>part<sp/>of<sp/>new<sp/>layer<sp/>too,<sp/>both<sp/>create<sp/>an<sp/>edge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>set<sp/>style<sp/>and<sp/>layer<sp/>in<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg.style<sp/>=<sp/>style</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg.layerIdx<sp/>=<sp/>currentLayerIdx</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>layer.append(seg)</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coords<sp/>=<sp/>seg.coords</highlight></codeline>
<codeline lineno="394"><highlight class="normal"></highlight></codeline>
<codeline lineno="395" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a598a5c57e9516d9f6c97f082cd4934db" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1a598a5c57e9516d9f6c97f082cd4934db" kindref="member">subdivide</ref>(self,<sp/>subd_threshold):</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>smart<sp/>subdivide</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>divide<sp/>edge<sp/>if<sp/>&gt;<sp/>subd_threshold</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>do<sp/>it<sp/>in<sp/>parser<sp/>to<sp/>keep<sp/>index<sp/>order<sp/>of<sp/>vertex<sp/>and<sp/>travel/extrude<sp/>info</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>segmentation<sp/>of<sp/>path<sp/>necessary<sp/>for<sp/>manipulation<sp/>of<sp/>color,<sp/>continous<sp/>deforming<sp/>ect.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subdivided_segs<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>start<sp/>model<sp/>at<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coords<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">:<sp/>0.0,</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;F&quot;</highlight><highlight class="normal">:<sp/>0.0,<sp/><sp/></highlight><highlight class="comment">#<sp/>no<sp/>interpolation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">:<sp/>0.0}</highlight></codeline>
<codeline lineno="409"><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>seg<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa72471c5bb5d8309023c6b82dc34d284" kindref="member">segments</ref>:</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>calc<sp/>XYZ<sp/>distance</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d<sp/>=<sp/>(seg.coords[</highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">]<sp/>-<sp/>coords[</highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">])<sp/>**<sp/>2</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d<sp/>+=<sp/>(seg.coords[</highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">]<sp/>-<sp/>coords[</highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">])<sp/>**<sp/>2</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d<sp/>+=<sp/>(seg.coords[</highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">]<sp/>-<sp/>coords[</highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">])<sp/>**<sp/>2</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg.distance<sp/>=<sp/>math.sqrt(d)</highlight></codeline>
<codeline lineno="416"><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>seg.distance<sp/>&gt;<sp/>subd_threshold:</highlight></codeline>
<codeline lineno="418"><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subdivs<sp/>=<sp/>math.ceil(</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg.distance<sp/>/<sp/>subd_threshold)<sp/><sp/></highlight><highlight class="comment">#<sp/>ceil<sp/>makes<sp/>sure<sp/>that<sp/>linspace<sp/>interval<sp/>is<sp/>at<sp/>least<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>P1<sp/>=<sp/>coords</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>P2<sp/>=<sp/>seg.coords</highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>interpolated<sp/>points</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interp_coords<sp/>=<sp/>np.linspace(list(P1.values()),<sp/>list(</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>P2.values()),<sp/>num=subdivs,<sp/>endpoint=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(interp_coords)):<sp/><sp/></highlight><highlight class="comment">#<sp/>inteprolated<sp/>points<sp/>array<sp/>back<sp/>to<sp/>segment<sp/>object</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_coords<sp/>=<sp/>{</highlight><highlight class="stringliteral">&quot;X&quot;</highlight><highlight class="normal">:<sp/>interp_coords[i][0],<sp/></highlight><highlight class="stringliteral">&quot;Y&quot;</highlight><highlight class="normal">:<sp/>interp_coords[i][1],<sp/></highlight><highlight class="stringliteral">&quot;Z&quot;</highlight><highlight class="normal">:<sp/>interp_coords[i][2],</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;F&quot;</highlight><highlight class="normal">:<sp/>seg.coords[</highlight><highlight class="stringliteral">&quot;F&quot;</highlight><highlight class="normal">]}</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>E/subdivs<sp/>is<sp/>for<sp/>relative<sp/>extrusion,<sp/>absolute<sp/>extrusion<sp/>need<sp/>&quot;E&quot;:interp_coords[i][4]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>print(&quot;interp_coords_new:&quot;,<sp/>new_coords)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>seg.coords[</highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">]<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_coords[</highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">]<sp/>=<sp/>round(seg.coords[</highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">]<sp/>/<sp/>(subdivs<sp/>-<sp/>1),<sp/>5)</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_coords[</highlight><highlight class="stringliteral">&quot;E&quot;</highlight><highlight class="normal">]<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>make<sp/>sure<sp/>P1<sp/>hasn&apos;t<sp/>been<sp/>written<sp/>before,<sp/>compare<sp/>with<sp/>previous<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>new_coords[</highlight><highlight class="stringliteral">&apos;X&apos;</highlight><highlight class="normal">]<sp/>!=<sp/>coords[</highlight><highlight class="stringliteral">&apos;X&apos;</highlight><highlight class="normal">]<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>new_coords[</highlight><highlight class="stringliteral">&apos;Y&apos;</highlight><highlight class="normal">]<sp/>!=<sp/>coords[</highlight><highlight class="stringliteral">&apos;Y&apos;</highlight><highlight class="normal">]<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>new_coords[</highlight><highlight class="stringliteral">&apos;Z&apos;</highlight><highlight class="normal">]<sp/>!=<sp/>\</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coords[</highlight><highlight class="stringliteral">&apos;Z&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>write<sp/>segment<sp/>only<sp/>if<sp/>movement<sp/>changes,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>avoid<sp/>double<sp/>coordinates<sp/>due<sp/>to<sp/>same<sp/>start<sp/>and<sp/>endpoint<sp/>of<sp/>linspace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"></highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_seg<sp/>=<sp/><ref refid="classcam_1_1gcodeimportparser_1_1Segment" kindref="compound">Segment</ref>(seg.type,<sp/>new_coords,<sp/>seg.color,</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg.toolnumber,<sp/>seg.lineNb,<sp/>seg.line)</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_seg.layerIdx<sp/>=<sp/>seg.layerIdx</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_seg.style<sp/>=<sp/>seg.style</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subdivided_segs.append(new_seg)</highlight></codeline>
<codeline lineno="450"><highlight class="normal"></highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subdivided_segs.append(seg)</highlight></codeline>
<codeline lineno="453"><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>coords<sp/>=<sp/>seg.coords<sp/><sp/></highlight><highlight class="comment">#<sp/>P1<sp/>becomes<sp/>P2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa72471c5bb5d8309023c6b82dc34d284" kindref="member">segments</ref><sp/>=<sp/>subdivided_segs</highlight></codeline>
<codeline lineno="457"><highlight class="normal"></highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>create<sp/>blender<sp/>curve<sp/>and<sp/>vertex_info<sp/>in<sp/>text<sp/>file(coords,<sp/>style,<sp/>color...)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="459" refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1ab3b35fbaaa6dac1438210fb3e595633c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1ab3b35fbaaa6dac1438210fb3e595633c" kindref="member">draw</ref>(self,<sp/>split_layers=False):</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>split_layers:</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>layer<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1ae49c085578c03aad45f407ec544c883f" kindref="member">layers</ref>:</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verts,<sp/>edges<sp/>=<sp/><ref refid="namespacecam_1_1gcodeimportparser_1a0079f2bbd765282c819b15b22a8dbfba" kindref="member">segments_to_meshdata</ref>(layer)</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(verts)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacecam_1_1gcodeimportparser_1a78824264a84e441ecc7438b7f004ac36" kindref="member">obj_from_pydata</ref>(str(i),<sp/>verts,<sp/>edges,<sp/>close=</highlight><highlight class="keyword">False</highlight><highlight class="normal">,<sp/>collection_name=</highlight><highlight class="stringliteral">&quot;Layers&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>verts,<sp/>edges<sp/>=<sp/><ref refid="namespacecam_1_1gcodeimportparser_1a0079f2bbd765282c819b15b22a8dbfba" kindref="member">segments_to_meshdata</ref>(self.<ref refid="classcam_1_1gcodeimportparser_1_1GcodeModel_1aa72471c5bb5d8309023c6b82dc34d284" kindref="member">segments</ref>)</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacecam_1_1gcodeimportparser_1a78824264a84e441ecc7438b7f004ac36" kindref="member">obj_from_pydata</ref>(</highlight><highlight class="stringliteral">&quot;Gcode&quot;</highlight><highlight class="normal">,<sp/>verts,<sp/>edges,<sp/>close=</highlight><highlight class="keyword">False</highlight><highlight class="normal">,<sp/>collection_name=</highlight><highlight class="stringliteral">&quot;Layers&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="471"><highlight class="normal"></highlight></codeline>
<codeline lineno="472"><highlight class="normal"></highlight></codeline>
<codeline lineno="473" refid="classcam_1_1gcodeimportparser_1_1Segment" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1Segment" kindref="compound">Segment</ref>:</highlight></codeline>
<codeline lineno="474" refid="classcam_1_1gcodeimportparser_1_1Segment_1a54682dc5dd952d0180e915ce6c92069f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a54682dc5dd952d0180e915ce6c92069f" kindref="member">__init__</ref>(self,<sp/>type,<sp/>coords,<sp/>color,<sp/>toolnumber,<sp/>lineNb,<sp/>line):</highlight></codeline>
<codeline lineno="475" refid="classcam_1_1gcodeimportparser_1_1Segment_1acdd2347bf8a6c9129c8f41d6250d4ea4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1acdd2347bf8a6c9129c8f41d6250d4ea4" kindref="member">type</ref><sp/>=<sp/>type</highlight></codeline>
<codeline lineno="476" refid="classcam_1_1gcodeimportparser_1_1Segment_1a3d3e22f76c5d4d5379a999456bde1905" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a3d3e22f76c5d4d5379a999456bde1905" kindref="member">coords</ref><sp/>=<sp/>coords</highlight></codeline>
<codeline lineno="477" refid="classcam_1_1gcodeimportparser_1_1Segment_1a0ae33b94758f9d8ff0823c4443b5f0fe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a0ae33b94758f9d8ff0823c4443b5f0fe" kindref="member">color</ref><sp/>=<sp/>color</highlight></codeline>
<codeline lineno="478" refid="classcam_1_1gcodeimportparser_1_1Segment_1a6b9cbf7a6e77d01ca60179556d6e6ec7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a6b9cbf7a6e77d01ca60179556d6e6ec7" kindref="member">toolnumber</ref><sp/>=<sp/>toolnumber</highlight></codeline>
<codeline lineno="479" refid="classcam_1_1gcodeimportparser_1_1Segment_1a54f17c0350148253305550b98c359a2d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a54f17c0350148253305550b98c359a2d" kindref="member">lineNb</ref><sp/>=<sp/>lineNb</highlight></codeline>
<codeline lineno="480" refid="classcam_1_1gcodeimportparser_1_1Segment_1a430f6fcf15d5040972b73017f6102083" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a430f6fcf15d5040972b73017f6102083" kindref="member">line</ref><sp/>=<sp/>line</highlight></codeline>
<codeline lineno="481" refid="classcam_1_1gcodeimportparser_1_1Segment_1acdb993e150ef8302de24e4339587d01f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1acdb993e150ef8302de24e4339587d01f" kindref="member">style</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="482" refid="classcam_1_1gcodeimportparser_1_1Segment_1a36c21a69af5c60f4fee2092724a22d59" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a36c21a69af5c60f4fee2092724a22d59" kindref="member">layerIdx</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"></highlight></codeline>
<codeline lineno="484" refid="classcam_1_1gcodeimportparser_1_1Segment_1a03e689de0991a335580c4bf2726423e7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a03e689de0991a335580c4bf2726423e7" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;<sp/>&lt;coords=%s,<sp/>lineNb=%d,<sp/>style=%s,<sp/>layerIdx=%d,<sp/>color=%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>\</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(str(self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a3d3e22f76c5d4d5379a999456bde1905" kindref="member">coords</ref>),<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a54f17c0350148253305550b98c359a2d" kindref="member">lineNb</ref>,<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1acdb993e150ef8302de24e4339587d01f" kindref="member">style</ref>,<sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a36c21a69af5c60f4fee2092724a22d59" kindref="member">layerIdx</ref>,<sp/>str(self.<ref refid="classcam_1_1gcodeimportparser_1_1Segment_1a0ae33b94758f9d8ff0823c4443b5f0fe" kindref="member">color</ref>))</highlight></codeline>
<codeline lineno="487"><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489" refid="classcam_1_1gcodeimportparser_1_1Layer" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1Layer" kindref="compound">Layer</ref>:</highlight></codeline>
<codeline lineno="490" refid="classcam_1_1gcodeimportparser_1_1Layer_1a7f7e58d5d8559af6bb7ea7091d226aef" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1Layer_1a7f7e58d5d8559af6bb7ea7091d226aef" kindref="member">__init__</ref>(self,<sp/>Z):</highlight></codeline>
<codeline lineno="491" refid="classcam_1_1gcodeimportparser_1_1Layer_1a45d4abaca085e5b1ca4b94f0b93160aa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Layer_1a45d4abaca085e5b1ca4b94f0b93160aa" kindref="member">Z</ref><sp/>=<sp/>Z</highlight></codeline>
<codeline lineno="492" refid="classcam_1_1gcodeimportparser_1_1Layer_1a94401e719268af526ee1a25c0a557c92" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Layer_1a94401e719268af526ee1a25c0a557c92" kindref="member">segments</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="493" refid="classcam_1_1gcodeimportparser_1_1Layer_1a29275fbe625bc73d51a7a5207e8d2a02" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Layer_1a29275fbe625bc73d51a7a5207e8d2a02" kindref="member">distance</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="494" refid="classcam_1_1gcodeimportparser_1_1Layer_1a128e44750c222cf2a0200fdbf6fbd9e2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classcam_1_1gcodeimportparser_1_1Layer_1a128e44750c222cf2a0200fdbf6fbd9e2" kindref="member">extrudate</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"></highlight></codeline>
<codeline lineno="496" refid="classcam_1_1gcodeimportparser_1_1Layer_1a129d8c9548364499a6eccc1e9890329c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classcam_1_1gcodeimportparser_1_1Layer_1a129d8c9548364499a6eccc1e9890329c" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;&lt;Layer:<sp/>Z=%f,<sp/>len(segments)=%d&gt;&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="classcam_1_1gcodeimportparser_1_1Layer_1a45d4abaca085e5b1ca4b94f0b93160aa" kindref="member">Z</ref>,<sp/>len(self.<ref refid="classcam_1_1gcodeimportparser_1_1Layer_1a94401e719268af526ee1a25c0a557c92" kindref="member">segments</ref>))</highlight></codeline>
<codeline lineno="498"><highlight class="normal"></highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>__name__<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;__main__&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="501" refid="namespacecam_1_1gcodeimportparser_1aac325098144266bd0a85ea3cd1d417c5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>path<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;test.gcode&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight></codeline>
<codeline lineno="503" refid="namespacecam_1_1gcodeimportparser_1a2496a51392df934f6ca93c535ac22ece" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>parser<sp/>=<sp/><ref refid="classcam_1_1gcodeimportparser_1_1GcodeParser" kindref="compound">GcodeParser</ref>()</highlight></codeline>
<codeline lineno="504" refid="namespacecam_1_1gcodeimportparser_1a005ba48098fc309c42cc78c99def7a4f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>model<sp/>=<sp/>parser.parseFile(path)</highlight></codeline>
    </programlisting>
    <location file="/tmp/github_repos_arch_doc_gen/SpectralVectors/blendercam/scripts/addons/cam/gcodeimportparser.py"/>
  </compounddef>
</doxygen>
